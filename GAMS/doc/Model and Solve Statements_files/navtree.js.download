var NAVTREEINDEX =
[
];

var navTreeSubIndices = new Array();

var browser = getBrowser();

function getBrowser(){
    var ua=navigator.userAgent,tem,M=ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i) || []; 
    if(/trident/i.test(M[1])) {
        tem=/\brv[ :]+(\d+)/g.exec(ua) || []; 
        return {name:'IE',version:(tem[1]||'')};
    }   
    if(M[1]==='Chrome') {
        tem=ua.match(/\bOPR\/(\d+)/)
        if(tem!=null)   {return {name:'Opera', version:tem[1]};}
    }   
    M=M[2]? [M[1], M[2]]: [navigator.appName, navigator.appVersion, '-?'];
    if((tem=ua.match(/version\/(\d+)/i))!=null) {M.splice(1,1,tem[1]);}
    return {
      name: M[0],
      version: M[1]
    };
 }
 
function getData(varName)
{
  var i = varName.lastIndexOf('/');
  var n = i>=0 ? varName.substring(i+1) : varName;
  return eval(n.replace(/\-/g,'_'));
}

function stripPath(uri)
{
  return uri.substring(uri.lastIndexOf('/')+1);
}

function stripPath2(uri)
{
  var i = uri.lastIndexOf('/');
  var s = uri.substring(i+1);
  var m = uri.substring(0,i+1).match(/\/d\w\/d\w\w\/$/);
  return m ? uri.substring(i-6) : s;
}

function hashValue()
{
  return $(location).attr('hash').substring(1).replace(/[^\w\-]/g,'');
}

function hashUrl()
{
  return '#'+hashValue();
}

function pathName()
{
  return $(location).attr('pathname').replace(/[^-A-Za-z0-9+&@#/%?=~_|!:,.;\(\)]/g, '');
}

function localStorageSupported()
{
  try {
    return 'localStorage' in window && window['localStorage'] !== null && window.localStorage.getItem;
  }
  catch(e) {
    return false;
  }
}


function storeLink(link)
{
  if (!$("#nav-sync").hasClass('sync') && localStorageSupported()) {
      window.localStorage.setItem('navpath',link);
  }
}

function deleteLink()
{
  if (localStorageSupported()) {
    window.localStorage.setItem('navpath','');
  }
}

function cachedLink()
{
  if (localStorageSupported()) {
    return window.localStorage.getItem('navpath');
  } else {
    return '';
  }
}

function getScript(scriptName,func)
{
  var head = document.getElementsByTagName("head")[0]; 
  var script = document.createElement('script');
  script.id = scriptName;
  script.type = 'text/javascript';
  script.onload = func; 
  script.src = scriptName+'.js'; 
  if (browser.name.localeCompare("MSIE") && browser.version<=8) {
    //if ($.browser.msie && $.browser.version<=8) { 
    // script.onload does not work with older versions of IE
    script.onreadystatechange = function() {
      if (script.readyState=='complete' || script.readyState=='loaded') { 
        func();
      }
    }
  }
  head.appendChild(script); 
}

function createIndent(o,domNode,node,level)
{
  var level=-1;
  var n = node;
  while (n.parentNode) { level++; n=n.parentNode; }
  if (node.childrenData) {
    var imgNode = document.createElement("img");
    imgNode.style.paddingLeft=(16*level).toString()+'px';
    imgNode.width  = 16;
    imgNode.height = 22;
    imgNode.border = 0;
    node.plus_img = imgNode;
    node.expandToggle = document.createElement("a");
    node.expandToggle.href = "javascript:void(0)";
    node.expandToggle.onclick = function() {
      if (node.expanded) {
        $(node.getChildrenUL()).slideUp("fast");
        node.plus_img.src = node.relpath+"ftv2pnode.png";
        node.expanded = false;
      } else {
        expandNode(o, node, false);
      }
      onNavSizeChanged("shown");
    }
    node.expandToggle.appendChild(imgNode);
    domNode.appendChild(node.expandToggle);
    imgNode.src = node.relpath+"ftv2pnode.png";
  } else {
    var span = document.createElement("span");
    span.style.display = 'inline-block';
    span.style.width   = 16*(level+1)+'px';
    span.style.height  = '22px';
    span.innerHTML = '&#160;';
    domNode.appendChild(span);
  } 
}

function getMarginPageHeight() {
    return 42;
}

function initContentPageHeight() {
   var marginHeight = getMarginPageHeight();
   if ($('#context-sidebar').length > 0) {
/*      var footerHeight = $('#footer-area').height();
      if ($('#gamsfooter').length > 0) 
          footerHeight = $('#footer-area').height() + $('#gamsfooter').height(); */
      var offsetHeight = $('#menu-area').height() ; 
      var navSize = 0; 
      if ($('#nav-tree').length > 0) 
         navsize = $('#nav-tree').height();
      var ctrlSize = 0;
      if ($('#ctrl-expand-collapse').length > 0) 
         ctrlSize = $('#ctrl-expand-collapse').height();
      var viewportHeight = $(window).height() - offsetHeight;

      var biggestHeight = Math.max( viewportHeight, $(document).height()  );
      biggestHeight = Math.max( biggestHeight, $('#doc-content').height() );
      biggestHeight = Math.max( biggestHeight, navSize + ctrlSize );

      if (viewportHeight < biggestHeight) {
          $('#content-area').height( biggestHeight /*- offsetHeight -footerHeight*/ +marginHeight);
          $('#context-sidebar').height( viewportHeight+marginHeight); 
          $('#doc-content').height( biggestHeight /*- offsetHeight -footerHeight*/ +marginHeight );
      } else {
          $('#content-area').height( biggestHeight +marginHeight );
          $('#context-sidebar').height( biggestHeight+marginHeight ); 
          $('#doc-content').height( $('#context-sidebar').height() + marginHeight);
      }
      if ($('#split-bar').length > 0)
         $('#split-bar').height( $('#doc-content').height() +marginHeight);
   } 
}

function resizeContentPageWidth()  {
   var biggestWidth = defaultSidebarWidth;

   $("#selected").closest(".children_ul").each(function() {
        $(this).find("span.label").each(function() {
            if ($(this).is(':visible')) {
                if ($(this).width() > responsiveTopNavWidth) { 
                   biggestWidth = responsiveTopNavWidth;
                } else if ($(this).width() > biggestWidth ) {
                           biggestWidth = $(this).width();
                 }
            }
        });
   });

   $('#nav-area').width(biggestWidth);
   $('#nav-tree').width(biggestWidth);
   $('#nav-tree-contents').width (biggestWidth);
}

function onNavSizeChanged(toc) {
   resizeContentToHeaderAndFooter();
   if (toc == "shown")
      resizeContentPageWidth();  
}

function resizeContentToHeaderAndFooter() {
   $('#content-area').css('margin-top', $('#menu-area').height()+'px');
   if ($('#split-bar').length > 0) {
      $('#split-bar').css( 'height', $('#doc-content').height() +'px');
   } 
}

function hidePrinterFriendlyVersion() {
   if ($('#print').length > 0) {
      $('#print').hide();
   }
}

function showPrinterFriendlyVersion() {
   if ($('#print').length > 0) {
      $('#print').show();
   }
}

var animationInProgress = false;

function gotoAnchor(anchor,aname,updateLocation)
{
  var pos, docContent = $('#doc-content');
  var ancParent = $(anchor.parent());
  if (ancParent.hasClass('memItemLeft') ||
      ancParent.hasClass('fieldname') ||
      ancParent.hasClass('fieldtype') ||
      ancParent.is(':header'))
  {
    pos = ancParent.position().top;
  } else if (anchor.position()) {
    pos = anchor.position().top;
  }
  if (pos) {
    var dist = Math.abs(Math.min(
               pos-docContent.offset().top,
               docContent[0].scrollHeight-
               docContent.height()-docContent.scrollTop()));
    animationInProgress=true;
    docContent.animate({
      scrollTop: pos + docContent.scrollTop() - docContent.offset().top 
    },Math.max(50,Math.min(500,dist)),function(){
      if (updateLocation) { window.location.href=aname; }
      animationInProgress=false;
    });
  }
}

function newNode(o, po, text, link, childrenData, lastNode)
{
  var node = new Object();
  node.children = Array();
  node.childrenData = childrenData;
  node.depth = po.depth + 1;
  node.relpath = po.relpath;
  node.isLast = lastNode;

  node.li = document.createElement("li");
  po.getChildrenUL().appendChild(node.li);
  node.parentNode = po;

  node.itemDiv = document.createElement("div");
  node.itemDiv.className = "item";

  node.labelSpan = document.createElement("span");
  node.labelSpan.className = "label";

  createIndent(o,node.itemDiv,node,0);
  node.itemDiv.appendChild(node.labelSpan);
  node.li.appendChild(node.itemDiv);

  var a = document.createElement("a");
  node.labelSpan.appendChild(a);
  node.label = document.createTextNode(text);
  node.expanded = false;
  a.appendChild(node.label);
  if (link) {
    var url;
    if (link.substring(0,1)=='^') {
      url = link.substring(1);
      link = url;
    } else {
      url = node.relpath+link;
    }
    a.className = stripPath(link.replace('#',':'));
    a.id = url;
    /*a.target = 'contentFrame';*/
    if (link.indexOf('#')!=-1) {
      var aname = '#'+link.split('#')[1];
      var srcPage = stripPath(pathName());
      var targetPage = stripPath(link.split('#')[0]);
      a.href = url; /*srcPage!=targetPage ? url : "javascript:void(0)"; */
      a.onclick = function(){
         storeLink(link);
        if (!$(a).parent().parent().hasClass('selected'))
        {
          $('.item').removeClass('selected');
          $('.item').removeAttr('id');
          $(a).parent().parent().addClass('selected');
          $(a).parent().parent().attr('id','selected');
        }
        var anchor = $(aname);
        gotoAnchor(anchor,aname,true);
      };
    } else {
      a.href = url;
      a.onclick = function() { 
         storeLink(link); 
         if (!$(a).parent().parent().hasClass('selected'))
        {
          $('.item').removeClass('selected');
          $('.item').removeAttr('id');
          $(a).parent().parent().addClass('selected');
          $(a).parent().parent().attr('id','selected');
        }
        var anchor = $(aname);
        gotoAnchor(anchor,aname,true);
      }
    }
  } else {
    if (childrenData != null) 
    {
      a.className = "nolink";
      a.href = "javascript:void(0)";
      a.onclick = node.expandToggle.onclick;
    }
  }

  node.childrenUL = null;
  node.getChildrenUL = function() {
    if (!node.childrenUL) {
      node.childrenUL = document.createElement("ul");
      node.childrenUL.className = "children_ul";
      node.childrenUL.style.display = "none";
      node.li.appendChild(node.childrenUL);
    }
    return node.childrenUL;
  };

  return node;
}

function expandNode(o, node, imm)
{
  if (node.childrenData && !node.expanded) {
    if (typeof(node.childrenData)==='string') {
      var varName    = node.childrenData;
      getScript(node.relpath+varName,function(){
        node.childrenData = getData(varName);
        expandNode(o, node, imm);
      });
    } else {
      if (!node.childrenVisited) {
        getNode(o, node);
      } if (imm || (browser.name.localeCompare("MSIE") && browser.version>8)) {
        //if (imm || ($.browser.msie && $.browser.version>8)) { 
        // somehow slideDown jumps to the start of tree for IE9 :-(
        $(node.getChildrenUL()).show();
      } else {
        $(node.getChildrenUL()).slideDown("fast");
      }
      if (node.isLast) {
        node.plus_img.src = node.relpath+"ftv2mlastnode.png";
      } else {
        node.plus_img.src = node.relpath+"ftv2mnode.png";
      }
      node.expanded = true;
    }
  }
}

function glowEffect(n,duration)
{
  n.addClass('glow').delay(duration).queue(function(next){
    $(this).removeClass('glow');next();
  });
}

function highlightAnchor()
{
  var aname = hashUrl();
  var anchor = $(aname);
  if (anchor.parent().attr('class')=='memItemLeft'){
    var rows = $('.memberdecls tr[class$="'+hashValue()+'"]');
    glowEffect(rows.children(),200); // member without details
  } else if (anchor.parent().attr('class')=='fieldname'){
    glowEffect(anchor.parent().parent(),300); // enum value
  } else if (anchor.parent().attr('class')=='fieldtype'){
    glowEffect(anchor.parent().parent(),300); // struct field
  } else if (anchor.parent().is(":header")) {
    glowEffect(anchor.parent(),300); // section header
  } else {
    glowEffect(anchor.next(),300); // normal member
  }
  gotoAnchor(anchor,aname,false);
}

function selectAndHighlight(hash,n)
{
  var a;
  if (hash) {
    var link=stripPath(pathName())+':'+hash.substring(1);
    a=$('.item a[class$="'+link+'"]');
  }
  if (a && a.length) {
    a.parent().parent().addClass('selected');
    a.parent().parent().attr('id','selected');
    highlightAnchor();
  } else if (n) {
    $(n.itemDiv).addClass('selected');
    $(n.itemDiv).attr('id','selected');
  }
  if ($('#nav-tree-contents .item:first').hasClass('selected')) {
    $('#nav-sync').css('top','30px');
  } else {
    $('#nav-sync').css('top','5px');
  }
}

function showNode(o, node, index, hash)
{
  if (node && node.childrenData) {
    if (typeof(node.childrenData)==='string') {
      var varName    = node.childrenData;
      getScript(node.relpath+varName,function(){
        node.childrenData = getData(varName);
        showNode(o,node,index,hash);
      },true);
    } else {
      if (!node.childrenVisited) {
        getNode(o, node);
      }
      $(node.getChildrenUL()).css({'display':'block'});
      if (node.isLast) {
        node.plus_img.src = node.relpath+"ftv2mlastnode.png";
      } else {
        node.plus_img.src = node.relpath+"ftv2mnode.png";
      }
      node.expanded = true;
      var n = node.children[o.breadcrumbs[index]];
      if (index+1<o.breadcrumbs.length) {
        // console.log('>>>> index+1<o.breadcrumbs.length ', index, o.breadcrumbs);
        showNode(o,n,index+1,hash);
      } else {
        if (typeof(n.childrenData)==='string') {
          var varName = n.childrenData;
          getScript(n.relpath+varName,function(){
            n.childrenData = getData(varName);
            node.expanded=false;
            showNode(o,node,index,hash); // retry with child node expanded
          },true);
        } else {
          var rootBase = stripPath(o.toroot.replace(/\..+$/, ''));
          if (rootBase=="index" || rootBase=="pages" || rootBase=="search") {
            expandNode(o, n, true);
          }          
          selectAndHighlight(hash,n);
        }
      }
    }
  } else {
    selectAndHighlight(hash);
  }
}

function removeToInsertLater(element) {
  var parentNode = element.parentNode;
  var nextSibling = element.nextSibling;
  parentNode.removeChild(element);
  return function() {
    if (nextSibling) {
      parentNode.insertBefore(element, nextSibling);
    } else {
      parentNode.appendChild(element);
    }
  };
}

function getNode(o, po)
{
  var insertFunction = removeToInsertLater(po.li);
  po.childrenVisited = true;
  var l = po.childrenData.length-1;
  for (var i in po.childrenData) {
    var nodeData = po.childrenData[i];
    po.children[i] = newNode(o, po, nodeData[0], nodeData[1], nodeData[2],
      i==l);
  }
  insertFunction();
}

function gotoNode(o,subIndex,root,hash,relpath)
{
  var nti = navTreeSubIndices[subIndex][root+hash];
  o.breadcrumbs = $.extend(true, [], nti ? nti : navTreeSubIndices[subIndex][root]);
  if (!o.breadcrumbs && root!=NAVTREE[0][1]) { // fallback: show index
    navTo(o,NAVTREE[0][1],"",relpath);
    $('.item').removeClass('selected');
    $('.item').removeAttr('id');
  }
  if (o.breadcrumbs) {
    o.breadcrumbs.unshift(0); // add 0 for root node
    showNode(o, o.node, 0, hash);
  }
}

function navTo(o,root,hash,relpath)
{
  var link = cachedLink();
  if (link) {
    var parts = link.split('#');
    root = parts[0];
    if (parts.length>1) hash = '#'+parts[1].replace(/[^\w\-]/g,'');
    else hash='';
  }
  if (hash.match(/^#l\d+$/)) {
    var anchor=$('a[name='+hash.substring(1)+']');
    glowEffect(anchor.parent(),300); // line number
    hash=''; // strip line number anchors
  }
  var url=root+hash;
    
/*  var i=-1;
  while (NAVTREEINDEX[i+1]<=url) i++;
  if (i==-1) { i=0; root=NAVTREE[0][1]; } // fallback: show index */
  var i = 0;
  if (navTreeSubIndices[i]) {
    gotoNode(o,i,root,hash,relpath)
   } else {
    navTreeSubIndices[i] = '';
    gotoNode(o,i,root,hash,relpath);
 } 
}

function scrollTo(hash) {
    $(location).hash = "#" + hash;
}

function expandNodeAndClick(o, hash, path) {
   var idx = NAVTREEINDEX[path];  
   var len = idx.length;
   // expand first level under o
   var child = o.node.children[0];
   expandNode(o, child, false);  
   for (var i=2; i < len; i++) {
         if (i%2==1)
            continue;
         var c = child.children[idx[i]];
         expandNode(0, c, false);  
         child = c;
   }
   var l = document.getElementById(path);
   if (l)
      l.click();
}

function expandNodeAndHighlight(o, hash, path) {
   var idx = NAVTREEINDEX[path];  
   var len = idx.length;
   // expand first level under o
   var child = o.node.children[0];
   expandNode(o, child, false);  
   for (var i=2; i < len; i++) {
         if (i%2==1)
            continue;
         var c = child.children[idx[i]];
         expandNode(0, c, false);  
         child = c;
   }

   var a = document.getElementById(path);
   if (!$(a).parent().parent().hasClass('selected')) {
          $('.item').removeClass('selected');
          $('.item').removeAttr('id');
          $(a).parent().parent().addClass('selected');
          $(a).parent().parent().attr('id','selected');
   }
   selectAndHighlight(hash, child);
}

function initNavTree() /*toroot,relpath)*/
{
  var oldhref = window.location.href;
  var pathString = window.location.pathname;
  var root = "";
  if (root) {
      pathString = pathString.substring(root.length+1, pathString.length);
  } else {
      var docString = "docs/";
      var pos = pathString.lastIndexOf(docString);  // last occurrence of "docs/"
      pathString = pathString.substring(pos+docString.length, pathString.length);
  }
  var toroot = pathString;
  var relpath = "style/";
  var n = 1; 
  while(n < pathString.split("/").length) {
     relpath = "../".concat(relpath);
     n++;
  }  

  var o = new Object();
  o.toroot = toroot;
  o.node = new Object();
  o.node.li = document.getElementById("nav-tree-contents");
  o.node.childrenData = NAVTREE;
  o.node.children = new Array();
  o.node.childrenUL = document.createElement("ul");
  o.node.getChildrenUL = function() { return o.node.childrenUL; };
  o.node.li.appendChild(o.node.childrenUL);
  o.node.depth = 0;
  o.node.relpath = relpath;
  o.node.expanded = false;
  o.node.isLast = true;
  o.node.plus_img = document.createElement("img");
  o.node.plus_img.src = relpath+"ftv2pnode.png";
  o.node.plus_img.width = 16;
  o.node.plus_img.height = 22;

    navTo(o,toroot,hashUrl(),relpath);

    var tocString = "?toc=";
    var search =  $(location).attr('search');
    var hash =  $(location).attr('hash');
 
    if (search.substring(0, tocString.length)==tocString) {
       var path = "../".concat(search.substring(5).concat(hash));
       if (NAVTREEINDEX[path]) {
          expandNodeAndHighlight(o, hash, path);
       } else  {
          path = "../".concat(search.substring(5));
          if (NAVTREEINDEX[path]) {
              expandNodeAndHighlight(o, "#", path);
          } else  {  // expand root
             expandNodeAndHighlight(o, "#", "../welcome.html");
          }
       }
    } else {
       var path = "../".concat(toroot.concat(hash));
       if (NAVTREEINDEX[path]) {
          expandNodeAndHighlight(o, hash, path);
       } else  {
          path = "../".concat(pathString);
          if (NAVTREEINDEX[path]) {
              expandNodeAndHighlight(o, "#", path);
          } else  {  // expand root
             expandNodeAndHighlight(o, "#", "../welcome.html");
          }
       }
    }
    
   if ($('div#selected')) {
       $('div#selected')[0].scrollIntoView(true);
   }

   var toggleFooter = 0;
   $(window).scroll(function() {
       var sidebarHeight = $(window).height() - $('#menu-area').height(); 
       var docfooterHeight = $('#footer-area').height();
       var gamsfooterHeight = 0; 
       if ($("#gamsfooter").length > 0)
           gamsfooterHeight = $('#gamsfooter').height();      
       var offsetHeight = $(document).height() - ($(window).scrollTop() + $(window).height());
       if (offsetHeight < (docfooterHeight + gamsfooterHeight)) {
           toggleFooter = 1;
           var offset = (docfooterHeight + gamsfooterHeight) - offsetHeight;
           $('#context-sidebar').css('height', (sidebarHeight - offset) +'px'); 
           $('#split-bar').css( 'height', $('#doc-content').height() +'px'); 
       } else if (toggleFooter == 1) {
           toggleFooter = 0;
           $('#context-sidebar').css('height', (sidebarHeight) +'px'); 
           $('#split-bar').css( 'height', $('#doc-content').height() +'px'); 
       }
   });

  $(window).on("hashchange", function(e) {
     if (window.location.hash && window.location.hash.length>1){
       var a;
       if ($(location).attr('hash')){
         var clslink=stripPath(pathName())+':'+hashValue();
          a=$('.item a[class$="'+clslink.replace(/</g,'\\3c ')+'"]');
       }
       if (a==null || !$(a).parent().parent().hasClass('selected')){
         $('.item').removeClass('selected');
         $('.item').removeAttr('id');
       }
       /*
       var link=stripPath2(pathName());
       navTo(o,link,hashUrl(),relpath);*/
       var path = "../".concat(toroot.concat(hashUrl()));
       if (NAVTREEINDEX[path]) {
          expandNodeAndHighlight(o, hashUrl(), path);
       } else  {
          path = "../".concat(pathString);
          if (NAVTREEINDEX[path]) {
              expandNodeAndHighlight(o, "#", path);
          } else  {
             expandNodeAndHighlight(o, "#", "../welcome.html");
          }
       }
       setTimeout(callback(hashValue()), 100);
     } 
  });
}

function getOffset( el ) {
  el = el.getBoundingClientRect();
  return {
    left: el.left + window.scrollX,
    top: el.top + window.scrollY
  }
}

function callback(h) {
   return function scrollToAnchor(){
      var top = getOffset( document.getElementById(h) ).top; 
      var offset = $('.topnav').height();
      if (offset) 
        offset +=20;
      else 
         offset = 60;
      $('html, body').animate({scrollTop: top-offset}, 10);
      highlightAnchor();
      originalBodyWidth = $('body').width();
      originalBodyHeight = $('body').height();
   }   
}

function getParameterByName(name, url) {
    if (!url) 
       url = window.location.href;
    name = name.replace(/[\[\]]/g, "\\$&");
    var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
    results = regex.exec(url);
    if (!results) return null;
    if (!results[2]) return '';
    return decodeURIComponent(results[2].replace(/\+/g, " "));
}

function removeElementById(id) {
    var elem = document.getElementById(id);
    return elem.parentNode.removeChild(elem);
}

function removeStylesheet(styleSheetId) {
    var sheet = document.getElementById(styleSheetId);
    sheet.disabled = true;
    return sheet.parentNode.removeChild(sheet);
}

function handleSearchKeyPress(e){
   var key=e.keyCode || e.which;
   if (key==13){
        forwardToSearchPage();
         return false; 
  }
  return true;
}

function handleSearchModlibsKeyPress(e){
   var key=e.keyCode || e.which;
   if (key==13){
        var query = $('#searchbar').val();
        var location = window.location.href;
        var parts = location.split('/');
        var lastSegment = parts.pop() || parts.pop(); 
        var doctype = parts.pop();
        if (doctype.localeCompare("libhtml")===0) {
            var newlocation = parts.join('/');
            lastSegment = parts.pop();
            window.location.href = newlocation.replace(lastSegment, 'docs/searchmodlibs.html?q='+query);
            return false; 
        } else if (doctype.localeCompare("docs")===0) {
                         window.location.href = location.replace(lastSegment, 'search.html?q='+query); 
                         return false; 
        }
  }
  return true;
}

function forwardToSearchPage() {
    var query = $('#searchbar').val();
    var location = window.location.href;
    var parts = location.split('/');
    var lastSegment = parts.pop() || parts.pop(); 
    if (lastSegment == "docs") { // eg. location = 'https://www.gams.com/31/docs/'
        if (location.endsWith('/')) {
            window.location.href = location.replace(lastSegment+'/', 'docs/search.html?q='+query);
        } else {
            window.location.href = location.replace(lastSegment, 'docs/search.html?q='+query);
        }
        return false;
    } 
    if (lastSegment.localeCompare("modlibs.html")===0) { /* docs/modlibs.html */
        window.location.href = location.replace(lastSegment, 'searchmodlibs.html?q='+query);
        return false;
    }
    var docsSegment = parts.pop();
    if (docsSegment == "docs") {
        window.location.href = location.replace(lastSegment, 'search.html?q='+query);
    } else {
        var path = new Array();
        path.push(lastSegment);
        path.unshift(docsSegment);
        path.unshift(parts.pop());
        var rootSegment = parts.pop();
        if (rootSegment == "docs")  {  /* docs/apis/xxx/lastSegment.html */
           window.location.href = location.replace(path.join('/'), 'search.html?q='+query);
        } else {  /* xxxlib_ml/libhtml/lastSegment.html */
           window.location.href = location.replace(path.join('/'), 'docs/search.html?q='+query);
        }
    } 
    return;
} 

function toggleTOC() {
   if (recallStatus("toc") == "shown") {
       restoreTOC("hidden");
       rememberStatus("toc", "hidden");
   } else {
       restoreTOC("shown");
       rememberStatus("toc", "shown");
   }
}

function rememberStatus(item, value) {
   if (typeof(Storage) !== "undefined") {
        localStorage.setItem(item, value);
   }
}

function recallStatus(item) {
   if (typeof(Storage) !== "undefined")
       return localStorage.getItem(item);
   else
       return typeof(Storage);
}

function toggleSubMenu(icon, menu) {
    if (icon.attr('class') == "icono-caretUp") {
        icon.attr('class', 'icono-caretDown');
        icon.attr('title', 'Expand submenu'); 
         if (!menu.hasClass("collapsed")) 
            menu.toggleClass("collapsed");
    } else {
        icon.attr('class', 'icono-caretUp');
        icon.attr('title', 'Collapse submenu'); 
        if (menu.hasClass("collapsed")) 
            menu.removeClass("collapsed");
    }
}

function resetSubMenu(icon, menu) {
    if (!menu.hasClass("collapsed")) {
       menu.toggleClass("collapsed");
    }
    if (icon.attr('class') == "icono-caretUp")
       icon.attr('class', 'icono-caretDown');
}

function toggleSideMenu(icon) {
    if (icon.attr('class') == "icono-caretLeftCircle")
       icon.attr('class', 'icono-caretRightCircle');
    else
       icon.attr('class', 'icono-caretLeftCircle');
}

function toggleResponsive() {
  var hamburger = $('#hamburger-nav');
  var menu = $('#menu-area');
  if (menu.hasClass("responsive")) {
      menu.removeClass("responsive");
      resetSubMenu($('#docs-menu-ctrl').find('i'), $('.docsmenu'));
      resetSubMenu($('#modlibs-menu-ctrl').find('i'), $('.modlibsmenu'));
      if (hamburger.hasClass("change"))
         hamburger.removeClass("change");
      hamburger.attr('title', 'Open Menu');
  } else {  
      menu.toggleClass("responsive");
      hamburger.toggleClass("change");
      hamburger.attr('title', 'Close Menu');
  }
  var content = $('#content-area');
  if (content.hasClass("reponsive")) {
      content.removeClass("responsive");
  } else { 
      content.toggleClass("responsive");
  }
}

function restoreTOC(value) {
   if(value == "hidden") { // hidden : collapse
        if ($('#nav-area').hasClass('expanded')) 
           $('#nav-area').removeClass('expanded');
        if (!$('#nav-area').hasClass('collapsed')) 
           $('#nav-area').toggleClass('collapsed');
        if ($('#context-sidebar').hasClass('menu-expanded')) 
           $('#context-sidebar').removeClass('menu-expanded');
        if (!$('#context-sidebar').hasClass('menu-collapsed')) 
           $('#context-sidebar').toggleClass('menu-collapsed');
        if ($('#ctrl-toc-item').hasClass('menu-expanded'))
           $('#ctrl-toc-item').removeClass('menu-expanded');
        if (!$('#ctrl-toc-item').hasClass('menu-collapsed'))
           $('#ctrl-toc-item').toggleClass('menu-collapsed');
        if ($('#split-bar').hasClass("expanded"))
            $('#split-bar').removeClass("expanded");
        if (!$('#split-bar').hasClass("collapsed"))
            $('#split-bar').toggleClass("collapsed");
        var i = $('#ctrl-expand-collapse').find('i')
        if (i)
          i.attr('class', 'icono-caretRightCircle');
        $('#ctrl-icon').attr('title', 'Show Table of Contents');
        $('#split-bar').attr('title', '');
        adjustContentPageWidth(minSidebarWidth);
   } else { // shown : expand
        if ($('#nav-area').hasClass('collapsed')) 
           $('#nav-area').removeClass('collapsed');
        if (!$('#nav-area').hasClass('expanded')) 
           $('#nav-area').toggleClass('expanded');
        if ($('#context-sidebar').hasClass('menu-collapsed')) 
           $('#context-sidebar').removeClass('menu-collapsed');
        if (!$('#context-sidebar').hasClass('menu-expanded')) 
           $('#context-sidebar').toggleClass('menu-expanded');
        if ($('#ctrl-toc-item').hasClass('menu-collapsed'))
           $('#ctrl-toc-item').removeClass('menu-collapsed');
        if (!$('#ctrl-toc-item').hasClass('menu-expanded'))
           $('#ctrl-toc-item').toggleClass('menu-expanded');
        if ($('#split-bar').hasClass("collapsed"))
            $('#split-bar').removeClass("collapsed");
        if (!$('#split-bar').hasClass("expanded"))
            $('#split-bar').toggleClass("expanded");
        var i = $('#ctrl-expand-collapse').find('i')
        if (i)
          i.attr('class', 'icono-caretLeftCircle');
        $('#ctrl-icon').attr('title', 'Hide Table of Contents');
        $('#split-bar').attr('title', 'Resize Table of Contents');
        adjustContentPageWidth(defaultSidebarWidth);
   }
}

function adjustContentPageWidth(width) {
   var sidebar = $('#context-sidebar');
   if (sidebar.length > 0)
      sidebar.css("width", width);

   var splitbar = $('#split-bar');
   if (splitbar.length > 0)   
      splitbar.css('margin-left', width+10);

   var doccontent = $('#doc-content');
   if (doccontent.length > 0)   
      doccontent.css('margin-left', 5); 

   var navarea = $('#nav-area');
   if (navarea.length > 0)   
      navarea.css("width", width);

   var navtree = $('#nav-tree');
   if (navtree.length > 0)   
      navtree.css("width", width);

   var navcontents = $('#nav-tree-contents');
   if (navcontents.length > 0)   
      navcontents.css("width", width);
}

function setURL(url) {
    var queryString = $("#query").val();
    if (queryString) {
       document.location.href = url + "?q=" + queryString;
    } else {
       document.location.href = url;
    }
}

function showSection(evt, sectionName) {
    var i, tablinks;

    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    evt.target.className += " active"; 
    performSearch();
}

function isLessThan(first, second) { 
    return (first < second);
}

function loadHighlight() {
    var q = getQueryVariable('search');
    if (q) {
        var queries = q.match(/\S+/g);
        if (queries.length > 0) {   
            var i=0;
            while ( queries.length > i) {
                 if (queries[i].toUpperCase() === "NOT") {
                    i+=2;
                 } else {
                      var query = getValidQuery(queries[i]);
                      if (query)
                          $('body').highlight(query);
                      i++;   
                 }
            }
            if ($('span.highlight').length > 0) {
                $('html, body').animate({
                   scrollTop: $('span.highlight').offset().top - 50
                }, 1000);
            }
         }
    }
}

function getQueryVariable(variable) {
    var query = window.location.search.substring(1);
    var vars = query.split('&');
    for (var i = 0; i < vars.length; i++) {
        var pair = vars[i].split('=');
        if (decodeURIComponent(pair[0]) == variable) {
            return decodeURIComponent(pair[1]); //.replace(/['"]+/g, '');
        }
    }
}

function getValidQuery(q) {
    var validQuery = "";
    if ((q.toUpperCase() === "AND") || (q.toUpperCase() === "OR") || q.startsWith("-"))
        return validQuery;
     
    validQuery = q;
    if (validQuery.startsWith("+") || validQuery.startsWith("*") || validQuery.startsWith("?")) 
        validQuery = validQuery.substring(1, validQuery.length);
        
    var n = validQuery.indexOf("*");
    if (n > -1) {
       validQuery = validQuery.substring(0, n);
    } else  {
       n = validQuery.indexOf("?");
       if (n > -1) {
          validQuery = validQuery.substring(0, n);
       }
    }
    return validQuery;
}

var minSidebarWidth = 30;
var minSplitbarMarginLeft = 160;
var minContentWidth = 400;
var defaultSidebarWidth = 240;
var defaultSidebarMargin = 10;
var defaultSplitbarWidth = 5;
var responsiveSidebarWidth = 10;
var responsiveTopNavWidth = 700;
var originalWindowHeight = $(window).height();
var originalWindowWidth = $(window).width();
var originalBodyHeight = 0;
var originalBodyWidth = 0; 

/*var min = 120;*/
var max = 3600;
/*var mainmin = 300;*/
$('#split-bar').mousedown(function (e) {
    e.preventDefault();
    var originalx = e.pageX;
    var maxdiff = 0; 
    $(document).mousemove(function (e) {
        e.preventDefault();
        var x = e.pageX - $('#context-sidebar').offset().left; /*$('#nav-tree').offset().left;*/
        if (x > minSplitbarMarginLeft && x < max && e.pageX < ($(window).width() - minContentWidth)) { 
          $('#context-sidebar').css("width", x);
          $('#nav-area').css("width", x);
          $('#nav-tree').css("width", x);
          $('#nav-tree-contents').css("width", x);
          $('#split-bar').css("margin-left", x+10);
          $('#content-area').css("cursor", "col-resize");
          var sidebarHeight = $(window).height() - $('#menu-area').height();
          $('#context-sidebar').css('height', (sidebarHeight) +'px'); 

          if (x > originalx) {
              var diff = x-defaultSidebarWidth-defaultSidebarMargin;
              if (diff > 0) {
                  var newh = $('#content-area').height();
                  if (diff > maxdiff) {
                     maxdiff = diff;
                     newh = $('#content-area').height() + diff*4;
                  } else {
                     newh = $('#content-area').height() - diff*4 ; 
                  } 
                  $('#content-area').height( newh );
                  $('#doc-content').height( newh ); 
                  $('#split-bar').height( newh );
              }
          }
        }
    })
});

$(document).mouseup(function (e) {
    $(document).unbind('mousemove');
    $('#content-area').css("cursor", "auto");
});

$(function() {
    function imageLoaded() {
       counter--; 
       if( counter === 0 ) { // last image loaded
           onPageLoaded();
       } 
    }
    var images = $('img');
    var counter = images.length;  // initialize the counter
    images.each(function() {
        if( this.complete ) {
            imageLoaded.call( this );
        } else {
            $(this).one('load', imageLoaded);
        }
    });
});

if (typeof MathJax !== 'undefined') {
   MathJax.Hub.Queue(function () { // when MathJax is done
      onPageLoaded();
      loadHighlight();
   });
} else {
    loadHighlight();
}

function onPageLoaded() {
    var height = $(window).height();
    originalWidth = $(window).width();
    if ($('#split-bar').length > 0) {
       $('#split-bar').css( "top", $('#menu-area').height());
       $('#split-bar').css( "height", $('#doc-content').height() /*$('body').height()*/ );
    } 
    initContentPageHeight();    
    if (window.location.hash) {  
       setTimeout(callback(hashValue()), 100);
    }
}

function init() {
   initNavTree();
   resizeContentToHeaderAndFooter();
   if ($(window).width() <= responsiveTopNavWidth) {
         rememberStatus("toc", "shown");
         rememberStatus("layout", "collapsed");
         $('#context-sidebar').hide();
         $('#split-bar').hide();
         if ($('#menu-area').hasClass("responsive"))
            $('#menu-area').removeClass("responsive");
         if ($('#content-area').hasClass("responsive"))
            $('#content-area').removeClass("responsive");
        adjustContentPageWidth(responsiveSidebarWidth);
        hidePrinterFriendlyVersion();
    } else {
        rememberStatus("layout", "expanded");
        $('#context-sidebar').show();
        $('#split-bar').show();
        var status = recallStatus("toc");
        restoreTOC(status);
        if (status == "shown")
           resizeContentPageWidth();  
        showPrinterFriendlyVersion();
   }  
}

function initTOCPage() {
    $('#ctrl-expand-collapse').click(function() {
       toggleSideMenu($(this).find('i'));
       toggleTOC();
    });

    $('#docs-menu-ctrl').click(function() {
       toggleSubMenu($(this).find('i'), $('.docsmenu'));
    });

    $('#modlibs-menu-ctrl').click(function() {
       toggleSubMenu($(this).find('i'), $('.modlibsmenu'));
    });

    $(window).on('resize', function(){
      if ($(this).width() <= responsiveTopNavWidth) {
         if (recallStatus("layout") == "expanded") {
            rememberStatus("layout", "collapsed");
            $('#context-sidebar').hide();
            $('#split-bar').hide();
            if ($('#menu-area').hasClass("responsive")) 
               $('#menu-area').removeClass("responsive");
            if ($('#content-area').hasClass("responsive"))
               $('#content-area').removeClass("responsive");
            adjustContentPageWidth(responsiveSidebarWidth);
            if ($('#hamburger-nav').hasClass("change"))
               $('#hamburger-nav').removeClass("change");
            if (!$('.docsmenu').hasClass("collapsed"))
               $('.docsmenu').removeClass("collapsed");
            if (!$('.modlibsmenu').hasClass("collapsed"))
               $('.modlibsmenu').removeClass("collapsed");
            resetSubMenu($('#docs-menu-ctrl').find('i'), $('.docsmenu'));
            resetSubMenu($('#modlibs-menu-ctrl').find('i'), $('.modlibsmenu'));
            hidePrinterFriendlyVersion();
         }
      }  else {
         if (recallStatus("layout") == "collapsed") {
            rememberStatus("layout", "expanded");
            $('#context-sidebar').show();
            $('#split-bar').show();
            var status = recallStatus("toc");
            restoreTOC(status);
            if (!$('.docsmenu').hasClass("collapsed"))
               $('.docsmenu').toggleClass("collapsed");
            if (!$('.modlibsmenu').hasClass("collapsed"))
               $('.modlibsmenu').toggleClass("collapsed");
            showPrinterFriendlyVersion();
        } 
      }
      onNavSizeChanged(recallStatus("toc"));

      if ($(this).width() < originalWindowWidth ) {
         var diffWidth = originalBodyWidth - $('body').width();
         var diffHeight = $('body').height() - originalBodyHeight;
         if (diffWidth > 0) {
             var newh = $('#doc-content').height() + diffHeight;
             $('#doc-content').height( newh );
             newh = $('#content-area').height() + diffHeight;
             $('#content-area').height( newh ); 
             $('#split-bar').height( newh );
         }
      }
      var diffWindowHeight = $(window).height() - originalWindowHeight;
      if ($(this).height() > originalWindowHeight) {
          var diffHeight = $(this).height() - originalWindowHeight;
          var newh = $('#context-sidebar').height() + diffHeight;
          $('#context-sidebar').height( newh ); 
          $('#split-bar').height( $('#doc-content').height() ); 
          if ($('#doc-content').height() < $(this).height()) {
             $('#doc-content').height( $(this).height() );
             $('#content-area').height( $(this).height() ); 
             $('#split-bar').height( $(this).height() );
          } 
      } 
    });
   
    $('#print').click( 
      function(e) {
         e.preventDefault();     
         var oldLocation = window.location.href;
         location = oldLocation+"?print=1"; 
         return false; 
       } 
    );

    var print = getParameterByName('print');
    if (print) {
      switch (print) {
        case '0': init();
                  removeElementById("print");
                  break;
        case '1': removeStylesheet("gamsstylesheet");
                  removeElementById("menu-area");
                  removeElementById("context-sidebar");
                  removeElementById("split-bar");
                  removeElementById("footer-area");
                  removeElementById("gamsfooter");
                  document.getElementById("doc-content").style.marginLeft = minSidebarWidth + "px";
                  break; 
        default: removeElementById("menu-area");
                 removeElementById("context-sidebar");
                 removeElementById("split-bar");
                 removeElementById("print");
                 removeElementById("footer-area");
                 removeElementById("gamsfooter");
                 document.getElementById("doc-content").style.marginLeft = minSidebarWidth + "px";
                 break;
      }
    } else {
        init();
    }
}

function initNoTOCPage() {
   resizeContentToHeaderAndFooter();

   $('#docs-menu-ctrl').click(function() {
       toggleSubMenu($(this).find('i'), $('.docsmenu'));
   });

   $('#modlibs-menu-ctrl').click(function() {
       toggleSubMenu($(this).find('i'), $('.modlibsmenu'));
   });

   $(window).on('resize', function(){
      if ($(this).width() <= responsiveTopNavWidth) {
         if (recallStatus("layout") == "expanded") {
            rememberStatus("layout", "collapsed");
            if ($('#menu-area').hasClass("responsive"))
               $('#menu-area').removeClass("responsive");
            if ($('#content-area').hasClass("responsive"))
               $('#content-area').removeClass("responsive");
            if ($('#hamburger-nav').hasClass("change"))
               $('#hamburger-nav').removeClass("change");
            if (!$('.docsmenu').hasClass("collapsed"))
               $('.docsmenu').removeClass("collapsed");
            if (!$('.modlibsmenu').hasClass("collapsed"))
               $('.modlibsmenu').removeClass("collapsed");
            resetSubMenu($('#docs-menu-ctrl').find('i'), $('.docsmenu'));
            resetSubMenu($('#modlibs-menu-ctrl').find('i'), $('.modlibsmenu'));
         }
      } else {
         if (recallStatus("layout") == "collapsed") {
            rememberStatus("layout", "expanded");
            if (!$('.docsmenu').hasClass("collapsed"))
               $('.docsmenu').toggleClass("collapsed");
            if (!$('.modlibsmenu').hasClass("collapsed"))
               $('.modlibsmenu').toggleClass("collapsed");
        }
      }
      onNavSizeChanged("hidden");
   }); 

   var print = getParameterByName('print');
   if (print) {
      switch (print) {
        case '1': removeStylesheet("gamsstylesheet");
                  removeElementById("menu-area");
                  removeElementById("footer-area");
                  removeElementById("gamsfooter");
                  break; 
        default: removeElementById("print");
                 break;
      }
   }
   if ($(window).width() <= responsiveTopNavWidth)
        rememberStatus("layout", "collapsed");
   else
        rememberStatus("layout", "expanded");
}

function initGAMSIDEPage() {
    $('#ctrl-expand-collapse').click(function() {
       toggleSideMenu($(this).find('i'));
       toggleTOC();
    });

    $('#docs-menu-ctrl').click(function() {
       toggleSubMenu($(this).find('i'), $('.docsmenu'));
    });

    $('#modlibs-menu-ctrl').click(function() {
       toggleSubMenu($(this).find('i'), $('.modlibsmenu'));
    });

    $(window).on('resize', function(){
      if ($(this).width() <= responsiveTopNavWidth) {
         if (recallStatus("layout") == "expanded") {
            rememberStatus("layout", "collapsed");
            $('#context-sidebar').hide();
            $('#split-bar').hide();
            if ($('#menu-area').hasClass("responsive")) 
               $('#menu-area').removeClass("responsive");
            if ($('#content-area').hasClass("responsive"))
               $('#content-area').removeClass("responsive");
            adjustContentPageWidth(responsiveSidebarWidth);
            if ($('#hamburger-nav').hasClass("change"))
               $('#hamburger-nav').removeClass("change");
            if (!$('.docsmenu').hasClass("collapsed"))
               $('.docsmenu').removeClass("collapsed");
            if (!$('.modlibsmenu').hasClass("collapsed"))
               $('.modlibsmenu').removeClass("collapsed");
            resetSubMenu($('#docs-menu-ctrl').find('i'), $('.docsmenu'));
            resetSubMenu($('#modlibs-menu-ctrl').find('i'), $('.modlibsmenu'));
            hidePrinterFriendlyVersion();
         }
      }  else {
         if (recallStatus("layout") == "collapsed") {
            rememberStatus("layout", "expanded");
            $('#context-sidebar').show();
            $('#split-bar').show();
            var status = recallStatus("toc");
            restoreTOC(status);
            if (!$('.docsmenu').hasClass("collapsed"))
               $('.docsmenu').toggleClass("collapsed");
            if (!$('.modlibsmenu').hasClass("collapsed"))
               $('.modlibsmenu').toggleClass("collapsed");
            showPrinterFriendlyVersion();
        } 
      }
      onNavSizeChanged(recallStatus("toc"));
      if ($(this).width() < originalWindowWidth ) {
         var diffWidth = originalBodyWidth - $('body').width();
         var diffHeight = $('body').height() - originalBodyHeight;
         if (diffWidth > 0) {
             var newh = $('#doc-content').height() + diffHeight;
             $('#doc-content').height( newh );
             newh = $('#content-area').height() + diffHeight;
             $('#content-area').height( newh ); 
             $('#split-bar').height( newh );
         }
      }
      var diffWindowHeight = $(window).height() - originalWindowHeight;
      if ($(this).height() > originalWindowHeight) {
          var diffHeight = $(this).height() - originalWindowHeight;
          var newh = $('#context-sidebar').height() + diffHeight;
          $('#context-sidebar').height( newh ); 
          $('#split-bar').height( $('#doc-content').height() ); 
          if ($('#doc-content').height() < $(this).height()) {
             $('#doc-content').height( $(this).height() );
             $('#content-area').height( $(this).height() ); 
             $('#split-bar').height( $(this).height() );
          } 
      } 
    });

    initNavTree();
    resizeContentToHeaderAndFooter();
    initContentPageHeight();
    if (isLessThan($(this).width(), responsiveTopNavWidth)) {
      rememberStatus("layout", "collapsed");
      $('#context-sidebar').hide();
      $('#split-bar').hide();
      if ($('#menu-area').hasClass("responsive")) {
         $('#menu-area').removeClass("responsive");
      }
      if ($('#content-area').hasClass("responsive")) {
         $('#content-area').removeClass("responsive");
      }
      adjustContentPageWidth(responsiveSidebarWidth);
    } else {
        rememberStatus("layout", "expanded");
        $('#context-sidebar').show();
        $('#split-bar').show();
        var status = recallStatus("toc");
        restoreTOC(status);
        onNavSizeChanged(status);
    }
}

function initSearchPage() {
   resizeContentToHeaderAndFooter();
   $('#docs-menu-ctrl').click(function() {
       toggleSubMenu($(this).find('i'), $('.docsmenu'));
   });

   $('#modlibs-menu-ctrl').click(function() {
       toggleSubMenu($(this).find('i'), $('.modlibsmenu'));
   });
   
   $(window).on('resize', function(){
      if ($(this).width() <= responsiveTopNavWidth) {
         if (recallStatus("layout") == "expanded") {
            rememberStatus("layout", "collapsed");
            if ($('#menu-area').hasClass("responsive"))
               $('#menu-area').removeClass("responsive");
            if ($('#content-area').hasClass("responsive"))
               $('#content-area').removeClass("responsive");
            if ($('#hamburger-nav').hasClass("change"))
               $('#hamburger-nav').removeClass("change");
            if (!$('.docsmenu').hasClass("collapsed"))
               $('.docsmenu').removeClass("collapsed");
            if (!$('.modlibsmenu').hasClass("collapsed"))
               $('.modlibsmenu').removeClass("collapsed");
            resetSubMenu($('#docs-menu-ctrl').find('i'), $('.docsmenu'));
            resetSubMenu($('#modlibs-menu-ctrl').find('i'), $('.modlibsmenu'));
         }
      } else {
         if (recallStatus("layout") == "collapsed") {
            rememberStatus("layout", "expanded");
            if (!$('.docsmenu').hasClass("collapsed"))
               $('.docsmenu').toggleClass("collapsed");
            if (!$('.modlibsmenu').hasClass("collapsed"))
               $('.modlibsmenu').toggleClass("collapsed");
        }
      }
      
      onNavSizeChanged("hidden");
   }); 

   if ($(window).width() <= responsiveTopNavWidth)
        rememberStatus("layout", "collapsed");
   else
        rememberStatus("layout", "expanded");
}

function initKeywordPage() {
   $('#content-area').css('top', $('#menu-area').height()+'px');
   var footer = $('#gamsfooter').find('.footer');
   if (footer.length > 0) {
      footer.css({'margin-top': '0px'});
   }

   $('#docs-menu-ctrl').click(function() {
       toggleSubMenu($(this).find('i'), $('.docsmenu'));
   });

   $('#modlibs-menu-ctrl').click(function() {
       toggleSubMenu($(this).find('i'), $('.modlibsmenu'));
   });

  $(window).on('resize', function(){
      if ($(this).width() <= responsiveTopNavWidth) {
         if (recallStatus("layout") == "expanded") {
            rememberStatus("layout", "collapsed");
            if ($('#menu-area').hasClass("responsive"))
               $('#menu-area').removeClass("responsive");
            if ($('#content-area').hasClass("responsive"))
               $('#content-area').removeClass("responsive");
            if ($('#hamburger-nav').hasClass("change"))
               $('#hamburger-nav').removeClass("change");
            if (!$('.docsmenu').hasClass("collapsed"))
               $('.docsmenu').removeClass("collapsed");
            if (!$('.modlibsmenu').hasClass("collapsed"))
               $('.modlibsmenu').removeClass("collapsed");
            resetSubMenu($('#docs-menu-ctrl').find('i'), $('.docsmenu'));
            resetSubMenu($('#modlibs-menu-ctrl').find('i'), $('.modlibsmenu'));
         }
      } else {
         if (recallStatus("layout") == "collapsed") {
            rememberStatus("layout", "expanded");
            if (!$('.docsmenu').hasClass("collapsed"))
               $('.docsmenu').toggleClass("collapsed");
            if (!$('.modlibsmenu').hasClass("collapsed"))
               $('.modlibsmenu').toggleClass("collapsed");
        }
      }
      
      onNavSizeChanged("hidden");
   }); 

   if ($(window).width() <= responsiveTopNavWidth)
        rememberStatus("layout", "collapsed");
   else
        rememberStatus("layout", "expanded");
}

